<header>
  <mat-toolbar color="primary">
    <button class="router-button" mat-icon-button routerLink="/">
      <mat-icon>close</mat-icon>
    </button>
    <span>Новое событие</span>
    <span class="spacer"></span>
    <button mat-icon-button form="ngEventForm" [disabled]="eventForm.invalid">
      <mat-icon>check</mat-icon>
    </button>
  </mat-toolbar>
</header>

<main>
  <form
    class="form"
    [formGroup]="eventForm"
    (ngSubmit)="saveEvent()"
    id="ngEventForm"
  >
    <mat-form-field class="full-width">
      <mat-label>Название</mat-label>
      <input matInput formControlName="name" required="true" />
    </mat-form-field>

    <mat-form-field class="full-width">
      <mat-label>Дата проведения</mat-label>
      <input
        matInput
        [matDatepicker]="picker"
        formControlName="date"
        required="true"
      />
      <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>

    <p>Участники</p>
    <mat-form-field class="full-width">
      <input
        matInput
        formControlName="organizer"
        required="true"
        placeholder="Ваше имя"
      />
    </mat-form-field>

    <div
      *ngIf="members().errors?.hasMembersDuplicates"
      class="mat-form-field-invalid"
    >
      Имена участников не должны повторяться
    </div>

    <div
      *ngIf="eventForm.errors?.organizerInMembers"
      class="mat-form-field-invalid"
    >
      Организатор уже есть в списке участников
    </div>

    <div formArrayName="members">
      <mat-form-field
        class="full-width"
        *ngFor="let participant of members().controls; let i = index"
        [formGroupName]="i"
      >
        <input
          matInput
          formControlName="name"
          placeholder="Добавить участника"
        />
      </mat-form-field>
    </div>
  </form>
</main>
